#!/usr/local/bin/perl
# -*- coding: utf-8 mode:cperl -*-

package FilterOption;

use Moose;
with 'MooseX::Getopt';

has 'listen_path' => ( isa => 'Str', is => 'ro', default => '/var/run/smtpauth/filter.sock' );
has 'logger_path' => ( isa => 'Str', is => 'ro', default => '/var/run/smtpauth/log-collector.sock' );
has 'user'        => ( isa => 'Str', is => 'ro', default => 'smtpauth-filter' );
has 'group'       => ( isa => 'Str', is => 'ro', default => 'smtpauth-filter' );

no Moose;
__PACKAGE__->meta->make_immutable;

package main;

use strict;
use warnings;
use Milter::SMTPAuth::Filter;

my $options = FilterOption->new_with_options();

Milter::SMTPAuth::Filter::run( { listen_path => $options->listen_path(),
                                 logger_path => $options->logger_path(),
                                 user        => $options->user(),
                                 group       => $options->group() } );

